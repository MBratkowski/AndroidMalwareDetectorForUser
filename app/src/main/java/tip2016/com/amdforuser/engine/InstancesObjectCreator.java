package tip2016.com.amdforuser.engine;

import java.util.ArrayList;
import java.util.Arrays;

import weka.core.Attribute;
import weka.core.DenseInstance;
import weka.core.Instances;
import weka.core.Utils;

/**
 * Created by brate on 01.06.2016.
 */
public class InstancesObjectCreator {

    public static final String PERMISSION_ACCESS_CHECKIN_PROPERTIES = "android.permission.ACCESS_CHECKIN_PROPERTIES";
    public static final String PERMISSION_ACCESS_COARSE_LOCATION = "android.permission.ACCESS_COARSE_LOCATION";
    public static final String PERMISSION_ACCESS_FINE_LOCATION = "android.permission.ACCESS_FINE_LOCATION";
    public static final String PERMISSION_ACCESS_LOCATION_EXTRA_COMMANDS = "android.permission.ACCESS_LOCATION_EXTRA_COMMANDS";
    public static final String PERMISSION_ACCESS_NETWORK_STATE = "android.permission.ACCESS_NETWORK_STATE";
    public static final String PERMISSION_ACCESS_NOTIFICATION_POLICY = "android.permission.ACCESS_NOTIFICATION_POLICY";
    public static final String PERMISSION_ACCESS_WIFI_STATE = "android.permission.ACCESS_WIFI_STATE";
    public static final String PERMISSION_ACCOUNT_MANAGER = "android.permission.ACCOUNT_MANAGER";
    public static final String PERMISSION_ADD_VOICEMAIL = "com.android.voicemail.permission.ADD_VOICEMAIL";
    public static final String PERMISSION_BATTERY_STATS = "android.permission.BATTERY_STATS";
    public static final String PERMISSION_BIND_ACCESSIBILITY_SERVICE = "android.permission.BIND_ACCESSIBILITY_SERVICE";
    public static final String PERMISSION_BIND_APPWIDGET = "android.permission.BIND_APPWIDGET";
    public static final String PERMISSION_BIND_CARRIER_MESSAGING_SERVICE = "android.permission.BIND_CARRIER_MESSAGING_SERVICE";
    public static final String PERMISSION_BIND_CARRIER_SERVICES = "android.permission.BIND_CARRIER_SERVICES";
    public static final String PERMISSION_BIND_CHOOSER_TARGET_SERVICE = "android.permission.BIND_CHOOSER_TARGET_SERVICE";
    public static final String PERMISSION_BIND_DEVICE_ADMIN = "android.permission.BIND_DEVICE_ADMIN";
    public static final String PERMISSION_BIND_DREAM_SERVICE = "android.permission.BIND_DREAM_SERVICE";
    public static final String PERMISSION_BIND_INCALL_SERVICE = "android.permission.BIND_INCALL_SERVICE";
    public static final String PERMISSION_BIND_INPUT_METHOD = "android.permission.BIND_INPUT_METHOD";
    public static final String PERMISSION_BIND_MIDI_DEVICE_SERVICE = "android.permission.BIND_MIDI_DEVICE_SERVICE";
    public static final String PERMISSION_BIND_NFC_SERVICE = "android.permission.BIND_NFC_SERVICE";
    public static final String PERMISSION_BIND_NOTIFICATION_LISTENER_SERVICE = "android.permission.BIND_NOTIFICATION_LISTENER_SERVICE";
    public static final String PERMISSION_BIND_PRINT_SERVICE = "android.permission.BIND_PRINT_SERVICE";
    public static final String PERMISSION_BIND_REMOTEVIEWS = "android.permission.BIND_REMOTEVIEWS";
    public static final String PERMISSION_BIND_TELECOM_CONNECTION_SERVICE = "android.permission.BIND_TELECOM_CONNECTION_SERVICE";
    public static final String PERMISSION_BIND_TEXT_SERVICE = "android.permission.BIND_TEXT_SERVICE";
    public static final String PERMISSION_BIND_TV_INPUT = "android.permission.BIND_TV_INPUT";
    public static final String PERMISSION_BIND_VOICE_INTERACTION = "android.permission.BIND_VOICE_INTERACTION";
    public static final String PERMISSION_BIND_VPN_SERVICE = "android.permission.BIND_VPN_SERVICE";
    public static final String PERMISSION_BIND_WALLPAPER = "android.permission.BIND_WALLPAPER";
    public static final String PERMISSION_BLUETOOTH = "android.permission.BLUETOOTH";
    public static final String PERMISSION_BLUETOOTH_ADMIN = "android.permission.BLUETOOTH_ADMIN";
    public static final String PERMISSION_BLUETOOTH_PRIVILEGED = "android.permission.BLUETOOTH_PRIVILEGED";
    public static final String PERMISSION_BODY_SENSORS = "android.permission.BODY_SENSORS";
    public static final String PERMISSION_BROADCAST_PACKAGE_REMOVED = "android.permission.BROADCAST_PACKAGE_REMOVED";
    public static final String PERMISSION_BROADCAST_SMS = "android.permission.BROADCAST_SMS";
    public static final String PERMISSION_BROADCAST_STICKY = "android.permission.BROADCAST_STICKY";
    public static final String PERMISSION_BROADCAST_WAP_PUSH = "android.permission.BROADCAST_WAP_PUSH";
    public static final String PERMISSION_CALL_PHONE = "android.permission.CALL_PHONE";
    public static final String PERMISSION_CALL_PRIVILEGED = "android.permission.CALL_PRIVILEGED";
    public static final String PERMISSION_CAMERA = "android.permission.CAMERA";
    public static final String PERMISSION_CAPTURE_AUDIO_OUTPUT = "android.permission.CAPTURE_AUDIO_OUTPUT";
    public static final String PERMISSION_CAPTURE_SECURE_VIDEO_OUTPUT = "android.permission.CAPTURE_SECURE_VIDEO_OUTPUT";
    public static final String PERMISSION_CAPTURE_VIDEO_OUTPUT = "android.permission.CAPTURE_VIDEO_OUTPUT";
    public static final String PERMISSION_CHANGE_COMPONENT_ENABLED_STATE = "android.permission.CHANGE_COMPONENT_ENABLED_STATE";
    public static final String PERMISSION_CHANGE_CONFIGURATION = "android.permission.CHANGE_CONFIGURATION";
    public static final String PERMISSION_CHANGE_NETWORK_STATE = "android.permission.CHANGE_NETWORK_STATE";
    public static final String PERMISSION_CHANGE_WIFI_MULTICAST_STATE = "android.permission.CHANGE_WIFI_MULTICAST_STATE";
    public static final String PERMISSION_CHANGE_WIFI_STATE = "android.permission.CHANGE_WIFI_STATE";
    public static final String PERMISSION_CLEAR_APP_CACHE = "android.permission.CLEAR_APP_CACHE";
    public static final String PERMISSION_CONTROL_LOCATION_UPDATES = "android.permission.CONTROL_LOCATION_UPDATES";
    public static final String PERMISSION_DELETE_CACHE_FILES = "android.permission.DELETE_CACHE_FILES";
    public static final String PERMISSION_DELETE_PACKAGES = "android.permission.DELETE_PACKAGES";
    public static final String PERMISSION_DIAGNOSTIC = "android.permission.DIAGNOSTIC";
    public static final String PERMISSION_DISABLE_KEYGUARD = "android.permission.DISABLE_KEYGUARD";
    public static final String PERMISSION_DUMP = "android.permission.DUMP";
    public static final String PERMISSION_EXPAND_STATUS_BAR = "android.permission.EXPAND_STATUS_BAR";
    public static final String PERMISSION_FACTORY_TEST = "android.permission.FACTORY_TEST";
    public static final String PERMISSION_FLASHLIGHT = "android.permission.FLASHLIGHT";
    public static final String PERMISSION_GET_ACCOUNTS = "android.permission.GET_ACCOUNTS";
    public static final String PERMISSION_GET_ACCOUNTS_PRIVILEGED = "android.permission.GET_ACCOUNTS_PRIVILEGED";
    public static final String PERMISSION_GET_PACKAGE_SIZE = "android.permission.GET_PACKAGE_SIZE";
    public static final String PERMISSION_GET_TASKS = "android.permission.GET_TASKS";
    public static final String PERMISSION_GLOBAL_SEARCH = "android.permission.GLOBAL_SEARCH";
    public static final String PERMISSION_INSTALL_LOCATION_PROVIDER = "android.permission.INSTALL_LOCATION_PROVIDER";
    public static final String PERMISSION_INSTALL_PACKAGES = "android.permission.INSTALL_PACKAGES";
    public static final String PERMISSION_INSTALL_SHORTCUT = "com.android.launcher.permission.INSTALL_SHORTCUT";
    public static final String PERMISSION_INTERNET = "android.permission.INTERNET";
    public static final String PERMISSION_KILL_BACKGROUND_PROCESSES = "android.permission.KILL_BACKGROUND_PROCESSES";
    public static final String PERMISSION_LOCATION_HARDWARE = "android.permission.LOCATION_HARDWARE";
    public static final String PERMISSION_MANAGE_DOCUMENTS = "android.permission.MANAGE_DOCUMENTS";
    public static final String PERMISSION_MASTER_CLEAR = "android.permission.MASTER_CLEAR";
    public static final String PERMISSION_MEDIA_CONTENT_CONTROL = "android.permission.MEDIA_CONTENT_CONTROL";
    public static final String PERMISSION_MODIFY_AUDIO_SETTINGS = "android.permission.MODIFY_AUDIO_SETTINGS";
    public static final String PERMISSION_MODIFY_PHONE_STATE = "android.permission.MODIFY_PHONE_STATE";
    public static final String PERMISSION_MOUNT_FORMAT_FILESYSTEMS = "android.permission.MOUNT_FORMAT_FILESYSTEMS";
    public static final String PERMISSION_MOUNT_UNMOUNT_FILESYSTEMS = "android.permission.MOUNT_UNMOUNT_FILESYSTEMS";
    public static final String PERMISSION_NFC = "android.permission.NFC";
    public static final String PERMISSION_PACKAGE_USAGE_STATS = "android.permission.PACKAGE_USAGE_STATS";
    public static final String PERMISSION_PERSISTENT_ACTIVITY = "android.permission.PERSISTENT_ACTIVITY";
    public static final String PERMISSION_PROCESS_OUTGOING_CALLS = "android.permission.PROCESS_OUTGOING_CALLS";
    public static final String PERMISSION_READ_CALENDAR = "android.permission.READ_CALENDAR";
    public static final String PERMISSION_READ_CALL_LOG = "android.permission.READ_CALL_LOG";
    public static final String PERMISSION_READ_CONTACTS = "android.permission.READ_CONTACTS";
    public static final String PERMISSION_READ_EXTERNAL_STORAGE = "android.permission.READ_EXTERNAL_STORAGE";
    public static final String PERMISSION_READ_FRAME_BUFFER = "android.permission.READ_FRAME_BUFFER";
    public static final String PERMISSION_READ_INPUT_STATE = "android.permission.READ_INPUT_STATE";
    public static final String PERMISSION_READ_LOGS = "android.permission.READ_LOGS";
    public static final String PERMISSION_READ_PHONE_STATE = "android.permission.READ_PHONE_STATE";
    public static final String PERMISSION_READ_SMS = "android.permission.READ_SMS";
    public static final String PERMISSION_READ_SYNC_SETTINGS = "android.permission.READ_SYNC_SETTINGS";
    public static final String PERMISSION_READ_SYNC_STATS = "android.permission.READ_SYNC_STATS";
    public static final String PERMISSION_READ_VOICEMAIL = "com.android.voicemail.permission.READ_VOICEMAIL";
    public static final String PERMISSION_REBOOT = "android.permission.REBOOT";
    public static final String PERMISSION_RECEIVE_BOOT_COMPLETED = "android.permission.RECEIVE_BOOT_COMPLETED";
    public static final String PERMISSION_RECEIVE_MMS = "android.permission.RECEIVE_MMS";
    public static final String PERMISSION_RECEIVE_SMS = "android.permission.RECEIVE_SMS";
    public static final String PERMISSION_RECEIVE_WAP_PUSH = "android.permission.RECEIVE_WAP_PUSH";
    public static final String PERMISSION_RECORD_AUDIO = "android.permission.RECORD_AUDIO";
    public static final String PERMISSION_REORDER_TASKS = "android.permission.REORDER_TASKS";
    public static final String PERMISSION_REQUEST_IGNORE_BATTERY_OPTIMIZATIONS = "android.permission.REQUEST_IGNORE_BATTERY_OPTIMIZATIONS";
    public static final String PERMISSION_REQUEST_INSTALL_PACKAGES = "android.permission.REQUEST_INSTALL_PACKAGES";
    public static final String PERMISSION_RESTART_PACKAGES = "android.permission.RESTART_PACKAGES";
    public static final String PERMISSION_SEND_RESPOND_VIA_MESSAGE = "android.permission.SEND_RESPOND_VIA_MESSAGE";
    public static final String PERMISSION_SEND_SMS = "android.permission.SEND_SMS";
    public static final String PERMISSION_SET_ALARM = "com.android.alarm.permission.SET_ALARM";
    public static final String PERMISSION_SET_ALWAYS_FINISH = "android.permission.SET_ALWAYS_FINISH";
    public static final String PERMISSION_SET_ANIMATION_SCALE = "android.permission.SET_ANIMATION_SCALE";
    public static final String PERMISSION_SET_DEBUG_APP = "android.permission.SET_DEBUG_APP";
    public static final String PERMISSION_SET_PREFERRED_APPLICATIONS = "android.permission.SET_PREFERRED_APPLICATIONS";
    public static final String PERMISSION_SET_PROCESS_LIMIT = "android.permission.SET_PROCESS_LIMIT";
    public static final String PERMISSION_SET_TIME = "android.permission.SET_TIME";
    public static final String PERMISSION_SET_TIME_ZONE = "android.permission.SET_TIME_ZONE";
    public static final String PERMISSION_SET_WALLPAPER = "android.permission.SET_WALLPAPER";
    public static final String PERMISSION_SET_WALLPAPER_HINTS = "android.permission.SET_WALLPAPER_HINTS";
    public static final String PERMISSION_SIGNAL_PERSISTENT_PROCESSES = "android.permission.SIGNAL_PERSISTENT_PROCESSES";
    public static final String PERMISSION_STATUS_BAR = "android.permission.STATUS_BAR";
    public static final String PERMISSION_SYSTEM_ALERT_WINDOW = "android.permission.SYSTEM_ALERT_WINDOW";
    public static final String PERMISSION_TRANSMIT_IR = "android.permission.TRANSMIT_IR";
    public static final String PERMISSION_UNINSTALL_SHORTCUT = "com.android.launcher.permission.UNINSTALL_SHORTCUT";
    public static final String PERMISSION_UPDATE_DEVICE_STATS = "android.permission.UPDATE_DEVICE_STATS";
    public static final String PERMISSION_USE_FINGERPRINT = "android.permission.USE_FINGERPRINT";
    public static final String PERMISSION_USE_SIP = "android.permission.USE_SIP";
    public static final String PERMISSION_VIBRATE = "android.permission.VIBRATE";
    public static final String PERMISSION_WAKE_LOCK = "android.permission.WAKE_LOCK";
    public static final String PERMISSION_WRITE_APN_SETTINGS = "android.permission.WRITE_APN_SETTINGS";
    public static final String PERMISSION_WRITE_CALENDAR = "android.permission.WRITE_CALENDAR";
    public static final String PERMISSION_WRITE_CALL_LOG = "android.permission.WRITE_CALL_LOG";
    public static final String PERMISSION_WRITE_CONTACTS = "android.permission.WRITE_CONTACTS";
    public static final String PERMISSION_WRITE_EXTERNAL_STORAGE = "android.permission.WRITE_EXTERNAL_STORAGE";
    public static final String PERMISSION_WRITE_GSERVICES = "android.permission.WRITE_GSERVICES";
    public static final String PERMISSION_WRITE_SECURE_SETTINGS = "android.permission.WRITE_SECURE_SETTINGS";
    public static final String PERMISSION_WRITE_SETTINGS = "android.permission.WRITE_SETTINGS";
    public static final String PERMISSION_WRITE_SYNC_SETTINGS = "android.permission.WRITE_SYNC_SETTINGS";
    public static final String PERMISSION_WRITE_VOICEMAIL = "com.android.voicemail.permission.WRITE_VOICEMAIL";

    public ArrayList<String> mPermissionList = null; //ArrayList of permission names
    private Instances dataFrame = null; //Instances blueprint, ready to add objects

    public InstancesObjectCreator() {

        initListPermission();
        createDataFrame();
    }

    private void initListPermission() {

        mPermissionList = new ArrayList<>();

        mPermissionList.add(PERMISSION_ACCESS_CHECKIN_PROPERTIES);
        mPermissionList.add(PERMISSION_ACCESS_COARSE_LOCATION);
        mPermissionList.add(PERMISSION_ACCESS_FINE_LOCATION);
        mPermissionList.add(PERMISSION_ACCESS_LOCATION_EXTRA_COMMANDS);
        mPermissionList.add(PERMISSION_ACCESS_NETWORK_STATE);
        mPermissionList.add(PERMISSION_ACCESS_NOTIFICATION_POLICY);
        mPermissionList.add(PERMISSION_ACCESS_WIFI_STATE);
        mPermissionList.add(PERMISSION_ACCOUNT_MANAGER);
        mPermissionList.add(PERMISSION_ADD_VOICEMAIL);
        mPermissionList.add(PERMISSION_BATTERY_STATS);
        mPermissionList.add(PERMISSION_BIND_ACCESSIBILITY_SERVICE);
        mPermissionList.add(PERMISSION_BIND_APPWIDGET);
        mPermissionList.add(PERMISSION_BIND_CARRIER_MESSAGING_SERVICE);
        mPermissionList.add(PERMISSION_BIND_CARRIER_SERVICES);
        mPermissionList.add(PERMISSION_BIND_CHOOSER_TARGET_SERVICE);
        mPermissionList.add(PERMISSION_BIND_DEVICE_ADMIN);
        mPermissionList.add(PERMISSION_BIND_DREAM_SERVICE);
        mPermissionList.add(PERMISSION_BIND_INCALL_SERVICE);
        mPermissionList.add(PERMISSION_BIND_INPUT_METHOD);
        mPermissionList.add(PERMISSION_BIND_MIDI_DEVICE_SERVICE);
        mPermissionList.add(PERMISSION_BIND_NFC_SERVICE);
        mPermissionList.add(PERMISSION_BIND_NOTIFICATION_LISTENER_SERVICE);
        mPermissionList.add(PERMISSION_BIND_PRINT_SERVICE);
        mPermissionList.add(PERMISSION_BIND_REMOTEVIEWS);
        mPermissionList.add(PERMISSION_BIND_TELECOM_CONNECTION_SERVICE);
        mPermissionList.add(PERMISSION_BIND_TEXT_SERVICE);
        mPermissionList.add(PERMISSION_BIND_TV_INPUT);
        mPermissionList.add(PERMISSION_BIND_VOICE_INTERACTION);
        mPermissionList.add(PERMISSION_BIND_VPN_SERVICE);
        mPermissionList.add(PERMISSION_BIND_WALLPAPER);
        mPermissionList.add(PERMISSION_BLUETOOTH);
        mPermissionList.add(PERMISSION_BLUETOOTH_ADMIN);
        mPermissionList.add(PERMISSION_BLUETOOTH_PRIVILEGED);
        mPermissionList.add(PERMISSION_BODY_SENSORS);
        mPermissionList.add(PERMISSION_BROADCAST_PACKAGE_REMOVED);
        mPermissionList.add(PERMISSION_BROADCAST_SMS);
        mPermissionList.add(PERMISSION_BROADCAST_STICKY);
        mPermissionList.add(PERMISSION_BROADCAST_WAP_PUSH);
        mPermissionList.add(PERMISSION_CALL_PHONE);
        mPermissionList.add(PERMISSION_CALL_PRIVILEGED);
        mPermissionList.add(PERMISSION_CAMERA);
        mPermissionList.add(PERMISSION_CAPTURE_AUDIO_OUTPUT);
        mPermissionList.add(PERMISSION_CAPTURE_SECURE_VIDEO_OUTPUT);
        mPermissionList.add(PERMISSION_CAPTURE_VIDEO_OUTPUT);
        mPermissionList.add(PERMISSION_CHANGE_COMPONENT_ENABLED_STATE);
        mPermissionList.add(PERMISSION_CHANGE_CONFIGURATION);
        mPermissionList.add(PERMISSION_CHANGE_NETWORK_STATE);
        mPermissionList.add(PERMISSION_CHANGE_WIFI_MULTICAST_STATE);
        mPermissionList.add(PERMISSION_CHANGE_WIFI_STATE);
        mPermissionList.add(PERMISSION_CLEAR_APP_CACHE);
        mPermissionList.add(PERMISSION_CONTROL_LOCATION_UPDATES);
        mPermissionList.add(PERMISSION_DELETE_CACHE_FILES);
        mPermissionList.add(PERMISSION_DELETE_PACKAGES);
        mPermissionList.add(PERMISSION_DIAGNOSTIC);
        mPermissionList.add(PERMISSION_DISABLE_KEYGUARD);
        mPermissionList.add(PERMISSION_DUMP);
        mPermissionList.add(PERMISSION_EXPAND_STATUS_BAR);
        mPermissionList.add(PERMISSION_FACTORY_TEST);
        mPermissionList.add(PERMISSION_FLASHLIGHT);
        mPermissionList.add(PERMISSION_GET_ACCOUNTS);
        mPermissionList.add(PERMISSION_GET_ACCOUNTS_PRIVILEGED);
        mPermissionList.add(PERMISSION_GET_PACKAGE_SIZE);
        mPermissionList.add(PERMISSION_GET_TASKS);
        mPermissionList.add(PERMISSION_GLOBAL_SEARCH);
        mPermissionList.add(PERMISSION_INSTALL_LOCATION_PROVIDER);
        mPermissionList.add(PERMISSION_INSTALL_PACKAGES);
        mPermissionList.add(PERMISSION_INSTALL_SHORTCUT);
        mPermissionList.add(PERMISSION_INTERNET);
        mPermissionList.add(PERMISSION_KILL_BACKGROUND_PROCESSES);
        mPermissionList.add(PERMISSION_LOCATION_HARDWARE);
        mPermissionList.add(PERMISSION_MANAGE_DOCUMENTS);
        mPermissionList.add(PERMISSION_MASTER_CLEAR);
        mPermissionList.add(PERMISSION_MEDIA_CONTENT_CONTROL);
        mPermissionList.add(PERMISSION_MODIFY_AUDIO_SETTINGS);
        mPermissionList.add(PERMISSION_MODIFY_PHONE_STATE);
        mPermissionList.add(PERMISSION_MOUNT_FORMAT_FILESYSTEMS);
        mPermissionList.add(PERMISSION_MOUNT_UNMOUNT_FILESYSTEMS);
        mPermissionList.add(PERMISSION_NFC);
        mPermissionList.add(PERMISSION_PACKAGE_USAGE_STATS);
        mPermissionList.add(PERMISSION_PERSISTENT_ACTIVITY);
        mPermissionList.add(PERMISSION_PROCESS_OUTGOING_CALLS);
        mPermissionList.add(PERMISSION_READ_CALENDAR);
        mPermissionList.add(PERMISSION_READ_CALL_LOG);
        mPermissionList.add(PERMISSION_READ_CONTACTS);
        mPermissionList.add(PERMISSION_READ_EXTERNAL_STORAGE);
        mPermissionList.add(PERMISSION_READ_FRAME_BUFFER);
        mPermissionList.add(PERMISSION_READ_INPUT_STATE);
        mPermissionList.add(PERMISSION_READ_LOGS);
        mPermissionList.add(PERMISSION_READ_PHONE_STATE);
        mPermissionList.add(PERMISSION_READ_SMS);
        mPermissionList.add(PERMISSION_READ_SYNC_SETTINGS);
        mPermissionList.add(PERMISSION_READ_SYNC_STATS);
        mPermissionList.add(PERMISSION_READ_VOICEMAIL);
        mPermissionList.add(PERMISSION_REBOOT);
        mPermissionList.add(PERMISSION_RECEIVE_BOOT_COMPLETED);
        mPermissionList.add(PERMISSION_RECEIVE_MMS);
        mPermissionList.add(PERMISSION_RECEIVE_SMS);
        mPermissionList.add(PERMISSION_RECEIVE_WAP_PUSH);
        mPermissionList.add(PERMISSION_RECORD_AUDIO);
        mPermissionList.add(PERMISSION_REORDER_TASKS);
        mPermissionList.add(PERMISSION_REQUEST_IGNORE_BATTERY_OPTIMIZATIONS);
        mPermissionList.add(PERMISSION_REQUEST_INSTALL_PACKAGES);
        mPermissionList.add(PERMISSION_RESTART_PACKAGES);
        mPermissionList.add(PERMISSION_SEND_RESPOND_VIA_MESSAGE);
        mPermissionList.add(PERMISSION_SEND_SMS);
        mPermissionList.add(PERMISSION_SET_ALARM);
        mPermissionList.add(PERMISSION_SET_ALWAYS_FINISH);
        mPermissionList.add(PERMISSION_SET_ANIMATION_SCALE);
        mPermissionList.add(PERMISSION_SET_DEBUG_APP);
        mPermissionList.add(PERMISSION_SET_PREFERRED_APPLICATIONS);
        mPermissionList.add(PERMISSION_SET_PROCESS_LIMIT);
        mPermissionList.add(PERMISSION_SET_TIME);
        mPermissionList.add(PERMISSION_SET_TIME_ZONE);
        mPermissionList.add(PERMISSION_SET_WALLPAPER);
        mPermissionList.add(PERMISSION_SET_WALLPAPER_HINTS);
        mPermissionList.add(PERMISSION_SIGNAL_PERSISTENT_PROCESSES);
        mPermissionList.add(PERMISSION_STATUS_BAR);
        mPermissionList.add(PERMISSION_SYSTEM_ALERT_WINDOW);
        mPermissionList.add(PERMISSION_TRANSMIT_IR);
        mPermissionList.add(PERMISSION_UNINSTALL_SHORTCUT);
        mPermissionList.add(PERMISSION_UPDATE_DEVICE_STATS);
        mPermissionList.add(PERMISSION_USE_FINGERPRINT);
        mPermissionList.add(PERMISSION_USE_SIP);
        mPermissionList.add(PERMISSION_VIBRATE);
        mPermissionList.add(PERMISSION_WAKE_LOCK);
        mPermissionList.add(PERMISSION_WRITE_APN_SETTINGS);
        mPermissionList.add(PERMISSION_WRITE_CALENDAR);
        mPermissionList.add(PERMISSION_WRITE_CALL_LOG);
        mPermissionList.add(PERMISSION_WRITE_CONTACTS);
        mPermissionList.add(PERMISSION_WRITE_EXTERNAL_STORAGE);
        mPermissionList.add(PERMISSION_WRITE_GSERVICES);
        mPermissionList.add(PERMISSION_WRITE_SECURE_SETTINGS);
        mPermissionList.add(PERMISSION_WRITE_SETTINGS);
        mPermissionList.add(PERMISSION_WRITE_SYNC_SETTINGS);
        mPermissionList.add(PERMISSION_WRITE_VOICEMAIL);

    }

    //Method to define attributes (permissions and class) and create object of Instances and assign it to dataFrame field
    private void createDataFrame() {

        if (mPermissionList != null) {
            ArrayList<Attribute> attributes = new ArrayList<>();

            //Adding permissions numeric attributes
            for (String permissionName : mPermissionList)
                attributes.add(new Attribute(permissionName));

            //Creating and adding class nominal attribute
            ArrayList<String> classes = new ArrayList<>(Arrays.asList("Software", "Malware"));
            attributes.add(new Attribute("Class", classes));

            dataFrame = new Instances("Applications", attributes, 0);
        }

    }

    //Method to add Instance (application permissions) to Instances object
    //If parameter data == null, then data == dataFrame (Instances blueprint, without any Instances, in method adding first Instance from "permissions")
    //Parameter "applicationsDataSet" - object of Instances - to it in method will be added Instance with values from chars from "permissions"
    //Parameter "permissions" - String with 135 characters (number of attributes of dataFrame without Class attribute), filled with 0 and 1 (ex. 00100100110100...)
    //Class "?"
    //Returning object of Instances from "pplicationsDataSet" parameter with added Instance with values from input "permissions"
    //Returning null if not succeed
    public Instances createInstancesObject(Instances applicationsDataSet, String permissions) {

        Instances data = null;

        if (applicationsDataSet == null && dataFrame != null)
            data = new Instances(dataFrame);
        else if (applicationsDataSet != null)
            data = new Instances(applicationsDataSet);

        if (permissions.length() == dataFrame.numAttributes() - 1 && data != null) {

            double[] values = new double[dataFrame.numAttributes()];

            for (int i = 0; i < dataFrame.numAttributes() - 1; i++)
                values[i] = Double.parseDouble(String.valueOf(permissions.charAt(i)));


            values[135] = Utils.missingValue(); //Class - unkown

            data.add(new DenseInstance(1.0, values));

        }

        return data;

    }

}
